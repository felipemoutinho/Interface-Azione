<!-- <h1>{{title}}</h1> -->

<div class="tab-container shadow p-3 mb-5 bg-body rounded">
  <form class="row g-3" [formGroup]="formGroup">
    <mat-tab-group>
      <mat-tab>
        <ng-template mat-tab-label>
          <mat-icon class="example-tab-icon">assignment</mat-icon>
          Dados Cliente
        </ng-template>

        <mat-radio-group (change)="radioChange($event)" [value]="tipoPessoa">
          <mat-label>Tipo Pessoa: </mat-label>
          <mat-radio-button *ngFor="let tp of tiposPessoas" [value]="tp.tipo">{{tp.descricao}}</mat-radio-button>
        </mat-radio-group>

        <div formGroupName="pessoa">

          <app-input-text
            titulo="Código Pessoa" 
            controlName="codigopessoa" 
            [formGroup]="FormGroupPessoa">
          </app-input-text>

          <app-input-text
            titulo="Nome" 
            controlName="nome" 
            [formGroup]="FormGroupPessoa">
          </app-input-text>

          <div formGroupName="pessoaFisica" *ngIf="tipoPessoa === 2">
            
            <app-input-text
              titulo="CPF" 
              controlName="cpf" 
              [formGroup]="FormGroupPessoaFisica">
            </app-input-text>

            <app-input-text
              titulo="Identidade" 
              controlName="identidade" 
              [formGroup]="FormGroupPessoaFisica">
            </app-input-text>

            <app-input-text
              titulo="Data Nascimento" 
              controlName="datanascimento" 
              [formGroup]="FormGroupPessoaFisica">
            </app-input-text>

            <app-input-select 
              titulo="Sexo" 
              controlName="sexo" 
              [formGroup]="FormGroupPessoaFisica"
              [optionList]="listaSexo">
            </app-input-select>

            <app-input-select 
              titulo="Estado Civil" 
              controlName="estadocivil" 
              [formGroup]="FormGroupPessoaFisica"
              [optionList]="listaEstadoCivil">
            </app-input-select>

            <app-input-text
              titulo="Nome Pai" 
              controlName="nomepai" 
              [formGroup]="FormGroupPessoaFisica">
            </app-input-text>

            <app-input-text
              titulo="Nome Mãe" 
              controlName="nomemae" 
              [formGroup]="FormGroupPessoaFisica">
            </app-input-text>

          </div>

          <div formGroupName="pessoaJuridica" *ngIf="tipoPessoa === 1">

            <app-input-text
              titulo="CNPJ" 
              controlName="cnpj" 
              [formGroup]="FormGroupPessoaJuridica">
            </app-input-text>

            <app-input-text
              titulo="Razão Social" 
              controlName="razaoSocial" 
              [formGroup]="FormGroupPessoaJuridica">
            </app-input-text>

            <app-input-text
              titulo="Nome Fantasia" 
              controlName="nomeFantasia" 
              [formGroup]="FormGroupPessoaJuridica">
            </app-input-text>

            <app-input-text
              titulo="Inscrição Municipal" 
              controlName="inscricaoMunicipal" 
              [formGroup]="FormGroupPessoaJuridica">
            </app-input-text>

            <app-input-text
              titulo="CNAE" 
              controlName="idcnae" 
              [formGroup]="FormGroupPessoaJuridica">
            </app-input-text>

            <app-input-text
              titulo="SUFRAMA" 
              controlName="suframa" 
              [formGroup]="FormGroupPessoaJuridica">
            </app-input-text>

            <app-input-select 
              titulo="Tipo Inscrição Estadual" 
              controlName="idindicadorInscEstadual" 
              [formGroup]="FormGroupPessoaJuridica"
              [optionList]="listaTipoInscricaoEstadual">
            </app-input-select>

            <app-input-text
              titulo="Inscrição Estadual" 
              controlName="inscricaoEstadual" 
              [formGroup]="FormGroupPessoaJuridica">
            </app-input-text>

            <app-input-select 
              titulo="Tipo Tributação" 
              controlName="idtributacao" 
              [formGroup]="FormGroupPessoaJuridica"
              [optionList]="listaTipoTributacao">
            </app-input-select>

            <app-input-text
              titulo="Data Fundação" 
              controlName="dataFundacao" 
              [formGroup]="FormGroupPessoaJuridica">
            </app-input-text>

            <mat-form-field class="col-md-2">
              <mat-label>Pessoa Jurídica Bloqueada</mat-label>
              <mat-select matInput formControlName="bloqueada">
                <mat-option [value]="true">Sim</mat-option>
                <mat-option [value]="false">Não</mat-option>
              </mat-select>
            </mat-form-field>

          </div>

        </div>
      </mat-tab>

      <mat-tab>
        <ng-template mat-tab-label>
          <mat-icon class="example-tab-icon">map_marked_alt</mat-icon>
          Endereço
        </ng-template>
        <div formGroupName="pessoa">
          <div formArrayName="enderecos">
            <div *ngFor="let end of EnderecoForms.controls; let i=index" [formGroupName]="i">

              <!-- <mat-form-field>
                <mat-label>Cep</mat-label>
                <input type="text" matInput formControlName="cep" (blur)="findEndereco()">
                <mat-error>
                  Por favor, informe o CEP
                </mat-error>
              </mat-form-field> -->

              <app-input-text
                titulo="Cep" 
                controlName="cep" 
                [formGroup]="FormGroupEndereco">
              </app-input-text>

              <app-input-text
                titulo="Logradouro" 
                controlName="logradouro" 
                [formGroup]="FormGroupEndereco">
              </app-input-text>

              <app-input-text
                titulo="Bairro" 
                controlName="bairro" 
                [formGroup]="FormGroupEndereco">
              </app-input-text>

              <app-input-text
                titulo="Número" 
                controlName="numero" 
                [formGroup]="FormGroupEndereco">
              </app-input-text>

              <app-input-text
                titulo="Complemento" 
                controlName="complemento" 
                [formGroup]="FormGroupEndereco">
              </app-input-text>

              <mat-form-field class="col-md-3">
                <mat-label>Estado</mat-label>
                <mat-select matInput formControlName="idestado">
                  <mat-option *ngFor="let estado of this.listaEstados" [value]="estado.idestado">{{estado.nome}}</mat-option>
                </mat-select>
                <mat-error>
                  Por favor, informe o estado
                </mat-error>
              </mat-form-field>

              <!-- <app-input-select 
                titulo="Estado" 
                controlName="idestado" 
                [formGroup]="FormGroupEndereco"
                [optionList]="listaEstados">
              </app-input-select> -->

              <app-input-text
                titulo="Cidade" 
                controlName="idcidade" 
                [formGroup]="FormGroupEndereco">
              </app-input-text>

              <app-input-text
                titulo="País" 
                controlName="idpais" 
                [formGroup]="FormGroupEndereco">
              </app-input-text>

              <mat-form-field>
                <mat-label>Endereço Principal</mat-label>
                <mat-select matInput formControlName="indprincipal">
                  <mat-option [value]="true">Sim</mat-option>
                  <mat-option [value]="false">Não</mat-option>
                </mat-select>
                <mat-error>
                  Por favor, informe se o endereço é o principal
                </mat-error>
              </mat-form-field>

            </div>
          </div>
        </div>

      </mat-tab>

      <mat-tab>
        <ng-template mat-tab-label>
          <mat-icon class="example-tab-icon">phone</mat-icon>
          Contato
        </ng-template>
        <div class="host" formGroupName="pessoa">
          <div formArrayName="contatos">
            <div *ngFor="let cont of ContatoForms.controls; let i=index" [formGroupName]="i">

              <app-input-select 
                titulo="Tipo Contato" 
                controlName="idtipocontato" 
                [formGroup]="FormGroupContato"
                [optionList]="listaTipoContato">
              </app-input-select>

              <app-input-text
                titulo="Descrição Contato" 
                controlName="descricaocontato" 
                [formGroup]="FormGroupContato">
              </app-input-text>

              <mat-form-field>
                <mat-label>Contato Principal</mat-label>
                <mat-select matInput formControlName="indcontatoprincipal">
                  <mat-option [value]="true">Sim</mat-option>
                  <mat-option [value]="false">Não</mat-option>
                </mat-select>
                <mat-error>
                  Por favor, informe se é o contato principal
                </mat-error>
              </mat-form-field>

            </div>
          </div>
        </div>
      </mat-tab>
    </mat-tab-group>

    <div>
      <button mat-flat-button color="accent" (click)="voltar()">Voltar</button>
      <button mat-flat-button color="primary" type="submit" (click)="onSubmit()" [disabled]="!formGroup.valid">Salvar</button>
    </div>

    <br>
    <br>
    Value: {{formGroup.value | json}}
    Valid: {{ formGroup.valid }}
  </form>
</div>
